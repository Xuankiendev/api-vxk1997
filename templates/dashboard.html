<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - API Platform</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="dashboard-header">
            <h1>Dashboard</h1>
            <button onclick="logout()" class="button logout-button">Logout</button>
        </div>

        <div class="api-key-section">
            <h2>Your API Key</h2>
            <div class="api-key-display">
                <code id="apiKeyDisplay"></code>
                <button onclick="copyApiKey()" class="button copy-button">Copy</button>
            </div>
        </div>

        <div class="test-endpoint">
            <h2>Test Endpoint</h2>
            <div class="endpoint-test">
                <input type="text" id="testMessage" placeholder="Enter message">
                <button onclick="testEndpoint()" class="button">Test Echo API</button>
            </div>
            <div id="testResult" class="result-display"></div>
        </div>

        <div class="api-docs">
            <h2>API Documentation</h2>
            <div class="endpoint-doc">
                <h3>Echo Endpoint</h3>
                <code>GET /api/echo?msg=hello&apikey=your-api-key</code>
                <p>Returns the message you send.</p>
            </div>
        </div>
    </div>

    <script>
        let apiKey = localStorage.getItem('apiKey');
        document.getElementById('apiKeyDisplay').textContent = apiKey;

        function copyApiKey() {
            navigator.clipboard.writeText(apiKey);
            alert('API Key copied to clipboard!');
        }

        async function testEndpoint() {
            const message = document.getElementById('testMessage').value;
            const resultDiv = document.getElementById('testResult');
            
            try {
                const response = await fetch(`/api/echo?msg=${encodeURIComponent(message)}&apikey=${apiKey}`);
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            <h4>Success!</h4>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="error">
                            <h4>Error!</h4>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        <h4>Error!</h4>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        function logout() {
            localStorage.removeItem('apiKey');
            window.location.href = '/';
        }

        if (!apiKey) {
            window.location.href = '/login';
        }
    </script>
</head>
</html>
